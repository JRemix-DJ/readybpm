$.fn.sparkline.tristate=tristate=createClass($.fn.sparkline._base,barHighlightMixin,{type:"tristate",init:function(t,i,a,e,r){var o=parseInt(a.get("barWidth"),10),l=parseInt(a.get("barSpacing"),10);tristate._super.init.call(this,t,i,a,e,r),this.regionShapes={},this.barWidth=o,this.barSpacing=l,this.totalBarWidth=o+l,this.values=$.map(i,Number),this.width=e=i.length*o+(i.length-1)*l,$.isArray(a.get("colorMap"))?(this.colorMapByIndex=a.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=a.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new RangeMap(this.colorMapByValue))),this.initTarget()},getRegion:function(t,i,a){return Math.floor(i/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:void 0===this.values[t],value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,i){var a=this.values,e=this.options,r=this.colorMapByIndex,o=this.colorMapByValue,l,s;return l=o&&(s=o.get(t))?s:r&&r.length>i?r[i]:a[i]<0?e.get("negBarColor"):0<a[i]?e.get("posBarColor"):e.get("zeroBarColor")},renderRegion:function(t,i){var a=this.values,e=this.options,r=this.target,o,l,s,h,n,c;if(o=r.pixelHeight,s=Math.round(o/2),h=t*this.totalBarWidth,l=a[t]<0?(n=s)-1:0<a[t]?(n=0,s-1):(n=s-1,2),null!==(c=this.calcColor(a[t],t)))return i&&(c=this.calcHighlightColor(c,e)),r.drawRect(h,n,this.barWidth-1,l-1,c,c)}});