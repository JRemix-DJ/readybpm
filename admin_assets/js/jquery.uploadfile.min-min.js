!function(S){null==S.fn.ajaxForm&&S.getScript(("https:"==document.location.protocol?"https://":"http://")+"malsup.github.io/jquery.form.js");var F={};F.fileapi=void 0!==S("<input type='file'/>").get(0).files,F.formdata=void 0!==window.FormData,S.fn.uploadFile=function(e){var o=S.extend({url:"",method:"POST",enctype:"multipart/form-data",returnType:null,allowDuplicates:!0,duplicateStrict:!1,allowedTypes:"*",acceptFiles:"*",fileName:"file",formData:{},dynamicFormData:function(){return{}},maxFileSize:-1,maxFileCount:-1,multiple:!0,dragDrop:!0,autoSubmit:!0,showCancel:!0,showAbort:!0,showDone:!0,showDelete:!1,showError:!0,showStatusAfterSuccess:!0,showStatusAfterError:!0,showFileCounter:!0,fileCounterStyle:"). ",showProgress:!1,nestedForms:!0,showDownload:!1,onLoad:function(e){},onSelect:function(e){return!0},onSubmit:function(e,t){},onSuccess:function(e,t,r,a){},onError:function(e,t,r,a){},onCancel:function(e,t){},downloadCallback:!1,deleteCallback:!1,afterUploadAll:!1,abortButtonClass:"ajax-file-upload-abort",cancelButtonClass:"ajax-file-upload-cancel",dragDropContainerClass:"ajax-upload-dragdrop",dragDropHoverClass:"state-hover",errorClass:"ajax-file-upload-error",uploadButtonClass:"ajax-file-upload",dragDropStr:"<span><b>Drag &amp; Drop Files</b></span>",abortStr:"Abort",cancelStr:"Cancel",deletelStr:"Delete",doneStr:"Done",multiDragErrorStr:"Multiple File Drag &amp; Drop is not allowed.",extErrorStr:"is not allowed. Allowed extensions: ",duplicateErrorStr:"is not allowed. File already exists.",sizeErrorStr:"is not allowed. Allowed Max size: ",uploadErrorStr:"Upload is not allowed",maxFileCountErrorStr:" is not allowed. Maximum allowed files are:",downloadStr:"Download",customErrorKeyStr:"jquery-upload-file-error",showQueueDiv:!1,statusBarWidth:500,dragdropWidth:500,showPreview:!1,previewHeight:"auto",previewWidth:"100%",uploadFolder:"uploads/"},e);this.fileCounter=1,this.selectedFiles=0,this.fCounter=0,this.sCounter=0,this.tCounter=0;var r="ajax-file-upload-"+(new Date).getTime();this.formGroup=r,this.hide(),this.errorLog=S("<div></div>"),this.after(this.errorLog),this.responses=[],this.existingFileNames=[],F.formdata||(o.dragDrop=!1),F.formdata||(o.multiple=!1);var a=this,s=S("<div>"+S(this).html()+"</div>");S(s).addClass(o.uploadButtonClass),function e(){if(S.fn.ajaxForm){if(o.dragDrop){var t=S('<div class="'+o.dragDropContainerClass+'" style="vertical-align:top;"></div>').width(o.dragdropWidth);S(a).before(t),S(t).append(s),S(t).append(S(o.dragDropStr)),i(a,o,t)}else S(a).before(s);o.onLoad.call(this,a),b(a,r,o,s)}else window.setTimeout(e,10)}(),this.startUpload=function(){S("."+this.formGroup).each(function(e,t){S(this).is("form")&&S(this).submit()})},this.getFileCount=function(){return a.selectedFiles},this.stopUpload=function(){S("."+o.abortButtonClass).each(function(e,t){S(this).hasClass(a.formGroup)&&S(this).click()})},this.cancelAll=function(){S("."+o.cancelButtonClass).each(function(e,t){S(this).hasClass(a.formGroup)&&S(this).click()})},this.update=function(e){o=S.extend(o,e)},this.createProgress=function(t){var r=new x(this,o);r.progressDiv.show(),r.progressbar.width("100%");var e="";e=o.showFileCounter?a.fileCounter+o.fileCounterStyle+t:t,r.filename.html(e),a.fileCounter++,a.selectedFiles++,o.showPreview&&(r.preview.attr("src",o.uploadFolder+t),r.preview.show()),o.showDownload&&(r.download.show(),r.download.click(function(){o.downloadCallback&&o.downloadCallback.call(a,[t])})),r.del.show(),r.del.click(function(){r.statusbar.hide().remove();var e=[t];o.deleteCallback&&o.deleteCallback.call(this,e,r),a.selectedFiles-=1,C(o,a)})};var t=!(this.getResponses=function(){return this.responses});function p(){o.afterUploadAll&&!t&&(t=!0,function e(){0!=a.sCounter&&a.sCounter+a.fCounter==a.tCounter?(o.afterUploadAll(a),t=!1):window.setTimeout(e,100)}())}function i(r,a,e){e.on("dragenter",function(e){e.stopPropagation(),e.preventDefault(),S(this).addClass(a.dragDropHoverClass)}),e.on("dragover",function(e){e.stopPropagation(),e.preventDefault();var t=S(this);t.hasClass(a.dragDropContainerClass)&&!t.hasClass(a.dragDropHoverClass)&&t.addClass(a.dragDropHoverClass)}),e.on("drop",function(e){e.preventDefault(),S(this).removeClass(a.dragDropHoverClass),r.errorLog.html("");var t=e.originalEvent.dataTransfer.files;!a.multiple&&1<t.length?a.showError&&S("<div class='"+a.errorClass+"'>"+a.multiDragErrorStr+"</div>").appendTo(r.errorLog):0!=a.onSelect(t)&&h(a,r,t)}),e.on("dragleave",function(e){S(this).removeClass(a.dragDropHoverClass)}),S(document).on("dragenter",function(e){e.stopPropagation(),e.preventDefault()}),S(document).on("dragover",function(e){e.stopPropagation(),e.preventDefault();var t=S(this);t.hasClass(a.dragDropContainerClass)||t.removeClass(a.dragDropHoverClass)}),S(document).on("drop",function(e){e.stopPropagation(),e.preventDefault(),S(this).removeClass(a.dragDropHoverClass)})}function f(e){var t="",r=e/1024,a;1024<parseInt(r)?t=(r/1024).toFixed(2)+" MB":t=r.toFixed(2)+" KB";return t}function m(e){var t=[],r=(t="string"==jQuery.type(e)?e.split("&"):S.param(e).split("&")).length,a=[],o,s;for(o=0;o<r;o++)t[o]=t[o].replace(/\+/g," "),s=t[o].split("="),a.push([decodeURIComponent(s[0]),decodeURIComponent(s[1])]);return a}function h(e,t,r){for(var a=0;a<r.length;a++)if(v(t,e,r[a].name))if(e.allowDuplicates||!g(t,r[a].name))if(-1!=e.maxFileSize&&r[a].size>e.maxFileSize)e.showError&&S("<div class='"+e.errorClass+"'><b>"+r[a].name+"</b> "+e.sizeErrorStr+f(e.maxFileSize)+"</div>").appendTo(t.errorLog);else if(-1!=e.maxFileCount&&t.selectedFiles>=e.maxFileCount)e.showError&&S("<div class='"+e.errorClass+"'><b>"+r[a].name+"</b> "+e.maxFileCountErrorStr+e.maxFileCount+"</div>").appendTo(t.errorLog);else{t.selectedFiles++,t.existingFileNames.push(r[a].name);var o=e,s=new FormData,i=e.fileName.replace("[]","");s.append(i,r[a]);var l=e.formData;if(l)for(var n=m(l),d=0;d<n.length;d++)n[d]&&s.append(n[d][0],n[d][1]);o.fileData=s;var u=new x(t,e),p="";p=e.showFileCounter?t.fileCounter+e.fileCounterStyle+r[a].name:r[a].name,u.filename.html(p);var c=S("<form style='display:block; position:absolute;left: 150px;' class='"+t.formGroup+"' method='"+e.method+"' action='"+e.url+"' enctype='"+e.enctype+"'></form>");c.appendTo("body");var h=[];h.push(r[a].name),D(c,o,u,h,t,r[a]),t.fileCounter++}else e.showError&&S("<div class='"+e.errorClass+"'><b>"+r[a].name+"</b> "+e.duplicateErrorStr+"</div>").appendTo(t.errorLog);else e.showError&&S("<div class='"+e.errorClass+"'><b>"+r[a].name+"</b> "+e.extErrorStr+e.allowedTypes+"</div>").appendTo(t.errorLog)}function v(e,t,r){var a=t.allowedTypes.toLowerCase().split(","),o=r.split(".").pop().toLowerCase();return!("*"!=t.allowedTypes&&jQuery.inArray(o,a)<0)}function g(e,t){var r=!1;if(e.existingFileNames.length)for(var a=0;a<e.existingFileNames.length;a++)(e.existingFileNames[a]==t||o.duplicateStrict&&e.existingFileNames[a].toLowerCase()==t.toLowerCase())&&(r=!0);return r}function c(e,t){if(e.existingFileNames.length)for(var r=0;r<t.length;r++){var a=e.existingFileNames.indexOf(t[r]);-1!=a&&e.existingFileNames.splice(a,1)}}function w(e,t){if(e){t.show();var r=new FileReader;r.onload=function(e){t.attr("src",e.target.result)},r.readAsDataURL(e)}}function C(s,e){if(s.showFileCounter){var i=S(".ajax-file-upload-filename").length;e.fileCounter=i+1,S(".ajax-file-upload-filename").each(function(e,t){var r=S(this).html().split(s.fileCounterStyle),a=parseInt(r[0])-1,o=i+s.fileCounterStyle+r[1];S(this).html(o),i--})}}function b(n,d,u,p){var e="ajax-upload-id-"+(new Date).getTime(),c=S("<form method='"+u.method+"' action='"+u.url+"' enctype='"+u.enctype+"'></form>"),t="<input type='file' id='"+e+"' name='"+u.fileName+"' accept='"+u.acceptFiles+"'/>";u.multiple&&(u.fileName.indexOf("[]")!=u.fileName.length-2&&(u.fileName+="[]"),t="<input type='file' id='"+e+"' name='"+u.fileName+"' accept='"+u.acceptFiles+"' multiple/>");var r=S(t).appendTo(c);r.change(function(){n.errorLog.html("");var e=u.allowedTypes.toLowerCase().split(","),t=[];if(this.files){for(i=0;i<this.files.length;i++)t.push(this.files[i].name);if(0==u.onSelect(this.files))return}else{var r=S(this).val(),a=[];if(t.push(r),!v(n,u,r))return void(u.showError&&S("<div class='"+u.errorClass+"'><b>"+r+"</b> "+u.extErrorStr+u.allowedTypes+"</div>").appendTo(n.errorLog));if(a.push({name:r,size:"NA"}),0==u.onSelect(a))return}if(C(u,n),p.unbind("click"),c.hide(),b(n,d,u,p),c.addClass(d),F.fileapi&&F.formdata){c.removeClass(d);var o=this.files;h(u,n,o)}else{for(var s="",i=0;i<t.length;i++)u.showFileCounter?s+=n.fileCounter+u.fileCounterStyle+t[i]+"<br>":s+=t[i]+"<br>",n.fileCounter++;if(-1!=u.maxFileCount&&n.selectedFiles+t.length>u.maxFileCount)return void(u.showError&&S("<div class='"+u.errorClass+"'><b>"+s+"</b> "+u.maxFileCountErrorStr+u.maxFileCount+"</div>").appendTo(n.errorLog));n.selectedFiles+=t.length;var l=new x(n,u);l.filename.html(s),D(c,u,l,t,n,null)}}),u.nestedForms?(c.css({margin:0,padding:0}),p.css({position:"relative",overflow:"hidden",cursor:"default"}),r.css({position:"absolute",cursor:"pointer",top:"0px",width:"100%",height:"100%",left:"0px","z-index":"100",opacity:"0.0",filter:"alpha(opacity=0)","-ms-filter":"alpha(opacity=0)","-khtml-opacity":"0.0","-moz-opacity":"0.0"}),c.appendTo(p)):(c.appendTo(S("body")),c.css({margin:0,padding:0,display:"block",position:"absolute",left:"-250px"}),-1!=navigator.appVersion.indexOf("MSIE ")?p.attr("for",e):p.click(function(){r.click()}))}function x(e,t){return this.statusbar=S("<div class='ajax-file-upload-statusbar'></div>").width(t.statusBarWidth),this.preview=S("<img class='ajax-file-upload-preview' />").width(t.previewWidth).height(t.previewHeight).appendTo(this.statusbar).hide(),this.filename=S("<div class='ajax-file-upload-filename'></div>").appendTo(this.statusbar),this.progressDiv=S("<div class='ajax-file-upload-progress'>").appendTo(this.statusbar).hide(),this.progressbar=S("<div class='ajax-file-upload-bar "+e.formGroup+"'></div>").appendTo(this.progressDiv),this.abort=S("<div class='ajax-file-upload-red "+t.abortButtonClass+" "+e.formGroup+"'>"+t.abortStr+"</div>").appendTo(this.statusbar).hide(),this.cancel=S("<div class='ajax-file-upload-red "+t.cancelButtonClass+" "+e.formGroup+"'>"+t.cancelStr+"</div>").appendTo(this.statusbar).hide(),this.done=S("<div class='ajax-file-upload-green'>"+t.doneStr+"</div>").appendTo(this.statusbar).hide(),this.download=S("<div class='ajax-file-upload-green'>"+t.downloadStr+"</div>").appendTo(this.statusbar).hide(),this.del=S("<div class='ajax-file-upload-red'>"+t.deletelStr+"</div>").appendTo(this.statusbar).hide(),t.showQueueDiv?S("#"+t.showQueueDiv).append(this.statusbar):e.errorLog.after(this.statusbar),this}function D(i,l,n,d,u,e){var t=null,r={cache:!1,contentType:!1,processData:!1,forceSync:!1,type:l.method,data:l.formData,formData:l.fileData,dataType:l.returnType,beforeSubmit:function(e,t,r){if(0==l.onSubmit.call(this,d))return n.statusbar.append("<div class='"+l.errorClass+"'>"+l.uploadErrorStr+"</div>"),n.cancel.show(),i.remove(),n.cancel.click(function(){c(u,d),n.statusbar.remove(),l.onCancel.call(u,d,n),u.selectedFiles-=d.length,C(l,u)}),!1;var a=l.dynamicFormData();if(a){var o=m(a);if(o)for(var s=0;s<o.length;s++)o[s]&&(null!=l.fileData?r.formData.append(o[s][0],o[s][1]):r.data[o[s][0]]=o[s][1])}return u.tCounter+=d.length,p(),!0},beforeSend:function(e,t){n.progressDiv.show(),n.cancel.hide(),n.done.hide(),l.showAbort&&(n.abort.show(),n.abort.click(function(){c(u,d),e.abort(),u.selectedFiles-=d.length})),F.formdata?n.progressbar.width("1%"):n.progressbar.width("5%")},uploadProgress:function(e,t,r,a){98<a&&(a=98);var o=a+"%";1<a&&n.progressbar.width(o),l.showProgress&&(n.progressbar.html(o),n.progressbar.css("text-align","center"))},success:function(e,t,r){if("json"==l.returnType&&"object"==S.type(e)&&e.hasOwnProperty(l.customErrorKeyStr)){n.abort.hide();var a=e[l.customErrorKeyStr];return l.onError.call(this,d,200,a,n),l.showStatusAfterError?(n.progressDiv.hide(),n.statusbar.append("<span class='"+l.errorClass+"'>ERROR: "+a+"</span>")):(n.statusbar.hide(),n.statusbar.remove()),u.selectedFiles-=d.length,i.remove(),void(u.fCounter+=d.length)}u.responses.push(e),n.progressbar.width("100%"),l.showProgress&&(n.progressbar.html("100%"),n.progressbar.css("text-align","center")),n.abort.hide(),l.onSuccess.call(this,d,e,r,n),l.showStatusAfterSuccess?(l.showDone?(n.done.show(),n.done.click(function(){n.statusbar.hide("slow"),n.statusbar.remove()})):n.done.hide(),l.showDelete?(n.del.show(),n.del.click(function(){n.statusbar.hide().remove(),l.deleteCallback&&l.deleteCallback.call(this,e,n),u.selectedFiles-=d.length,C(l,u)})):n.del.hide()):(n.statusbar.hide("slow"),n.statusbar.remove()),l.showDownload&&(n.download.show(),n.download.click(function(){l.downloadCallback&&l.downloadCallback(e)})),i.remove(),u.sCounter+=d.length},error:function(e,t,r){n.abort.hide(),"abort"==e.statusText?(n.statusbar.hide("slow").remove(),C(l,u)):(l.onError.call(this,d,t,r,n),l.showStatusAfterError?(n.progressDiv.hide(),n.statusbar.append("<span class='"+l.errorClass+"'>ERROR: "+r+"</span>")):(n.statusbar.hide(),n.statusbar.remove()),u.selectedFiles-=d.length),i.remove(),u.fCounter+=d.length}};l.showPreview&&null!=e&&"image"==e.type.toLowerCase().split("/").shift()&&w(e,n.preview),l.autoSubmit?i.ajaxSubmit(r):(l.showCancel&&(n.cancel.show(),n.cancel.click(function(){c(u,d),i.remove(),n.statusbar.remove(),l.onCancel.call(u,d,n),u.selectedFiles-=d.length,C(l,u)})),i.ajaxForm(r))}return this}}(jQuery);